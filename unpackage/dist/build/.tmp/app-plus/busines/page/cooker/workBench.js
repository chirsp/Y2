(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["busines/page/cooker/workBench"],{"244b":function(t,e,s){},4025:function(t,e,s){"use strict";var a=s("244b"),i=s.n(a);i.a},5984:function(t,e,s){"use strict";s.r(e);var a=s("75d8"),i=s.n(a);for(var o in a)"default"!==o&&function(t){s.d(e,t,function(){return a[t]})}(o);e["default"]=i.a},"75d8":function(t,e,s){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){return s.e("components/nodata").then(s.bind(null,"b7f3"))},o=function(){return s.e("components/drag-button").then(s.bind(null,"bc24"))},r={components:{xNodata:i,dragButton:o},data:function(){return{uid:t.getStorageSync("kejia_order_uid"),Alldish:{},typeSelect:!1,title:[{name:"菜名",width:"25%",align:"left"},{name:"制作状态",width:"25%",align:"left"},{name:"操作",width:"40%",align:"right"}],finishTitle:[{name:"菜品",width:"45%",align:"left"},{name:"制作环节",width:"35%",align:"center"},{name:"完成时间",width:"20%",align:"right"}],scrollLeft:0,dishStatus:[],numArry:[],TabCur:1,page:1,load:!1,orderlist:[],work_status:"",tab:[{name:"今日待办",status:"1"},{name:"今日已办",status:"3"}],newdishStatus:"",type:""}},onLoad:function(t){this.type=t.type,this.getUserInfo()},onReachBottom:function(){this.load||(this.page++,this.getorder())},onPullDownRefresh:function(){this.getorder()},onShow:function(){this.getdishStatus(),this.getdishStatus2()},methods:{getUserInfo:function(){var e=this;this.load=!0,this.$api.ajax("smdc/user/userinfo",{shop_id:this.$store.state.shopId},function(s){if(e.load=!1,!s.data.id){var a=e;return e.$api.toast("登录过期，请重新登录"),void setTimeout(function(){a.$api.openWin("/pages/login/login1")},1e3)}e.work_status=s.data.worker.work_status,e.orderlist.length=0,e.$api.setStorage("kejia_order_userInfo",s.data),t.setNavigationBarTitle({title:s.data.worker.type_name+"工作台"})})},lookDetail:function(t){this.orderlist[t][0].select=!this.orderlist[t][0].select},backMenu:function(){this.$api.openWin("/pages/personal-center/personal-center")},getdishStatus2:function(){var t=this;t.$api.ajax("smdc/food_process/processLists",{shop_id:t.$store.state.shopId},function(e){t.newdishStatus=e.data})},getdishStatus:function(){var e=this;e.$api.ajax("smdc/food_process/FoodProcessList",{shop_id:e.$store.state.shopId},function(s){e.Alldish=s.data,e.dishStatus=[];var a=t.getStorageSync("kejia_order_userInfo").worker.process;a.forEach(function(t){for(var a in s.data){var i={};a==t&&(i.status=a,i.name=s.data[a],e.dishStatus.push(i))}}),e.getorder()},"POST")},tabSelect:function(t){this.TabCur=t.currentTarget.dataset.id,this.page=1,this.scrollLeft=60*(t.currentTarget.dataset.id-1),this.orderlist.length=0,this.getorder()},TypeSelect:function(){this.typeSelect,this.typeSelect},makeStatusChange:function(t){var e=this.dishStatus[t.detail.value].status;this.getorder(e)},getorder:function(e){var s=this;if(e)var a=e;else{var i=t.getStorageSync("kejia_order_userInfo").worker.process;a=i.join(",")}var o={shop_id:s.$store.state.shopId,make_status:a,page:s.page};if(3==s.TabCur){var r="smdc/Worker/workload";o["type"]=s.type}else r="smdc/order/cookererOrder";s.$api.ajax(r,o,function(e){setTimeout(function(){t.stopPullDownRefresh()},2e3),s.numArry=[],e.data.map(function(t){if(s.numArry.push(t.length),3==s.TabCur){var e=t.create_time.split(" ");t.create_time=e[1]}else s.newdishStatus.map(function(e){e.id==t[0].make_status&&(t[0].is_num=e.is_num)})}),1==s.page?s.orderlist=e.data:s.orderlist=s.orderlist.concat(e.data)},"POST",!0)},addNums:function(t,e){console.log(a(2*e," at busines\\page\\cooker\\workBench.vue:317")),this.numArry[t]!=2*e?(this.numArry[t]=this.numArry[t]+1,this.$set(this.numArry,t,this.numArry[t])):this.$api.toast("制作份数超出限制")},removeNums:function(t){var e=this.numArry[t];1!=e&&(this.numArry[t]--,this.$set(this.numArry,t,this.numArry[t]))},changeStatus:function(t,e){var s=this.orderlist[t][0].make_status_type;this.$api.toast(t,e),0==s?this.makeDish(t):this.editstatus(t,e)},makeDish:function(e){var s=this,a=[];s.orderlist[e].forEach(function(t){a.push(t.id)}),s.$api.ajax("smdc/Sale_food/toUpdateMakeStatusType",{shop_id:s.$store.state.shopId,id:a.join(",")},function(e){s.$api.toast("操作成功~"),0==e.status?t.showModal({title:"系统提示",content:e.msg,success:function(t){t.confirm?s.getorder():t.cancel&&s.getorder()}}):s.getorder()},"POST",!0)},editstatus:function(e,s){var a=this,i=a.orderlist[e].length,o=[];if(i==s){a.orderlist[e].forEach(function(t){o.push(t.id)});var r={shop_id:a.$store.state.shopId,make_status:a.orderlist[e][0].make_status,id:o.join(",")}}else if(i>s){for(var n=[],u=0;u<a.orderlist[e].length;u++)u<s?o.push(a.orderlist[e][u].id):n.push(a.orderlist[e][u].id);r={shop_id:a.$store.state.shopId,make_status:a.orderlist[e][0].make_status,id:o.join(","),sale_food_id:n.join(",")}}else if(i<s){a.orderlist[e].forEach(function(t){o.push(t.id)});var d=s-i;r={shop_id:a.$store.state.shopId,make_status:a.orderlist[e][0].make_status,id:o.join(","),food_id:a.orderlist[e][0].food_id,num:d}}a.$api.ajax("smdc/Sale_food/toUpdateMakeStatus",r,function(e){0==e.status?t.showModal({title:"系统提示",content:e.msg,success:function(t){t.confirm?a.getorder():t.cancel&&a.getorder()}}):(a.$api.toast("操作成功"),a.getorder())},"POST",!0)}}};e.default=r}).call(this,s("6e42")["default"],s("0de9")["default"])},"7be9":function(t,e,s){"use strict";var a,i=function(){var t=this,e=t.$createElement;t._self._c},o=[];s.d(e,"b",function(){return i}),s.d(e,"c",function(){return o}),s.d(e,"a",function(){return a})},adbe:function(t,e,s){"use strict";s.r(e);var a=s("7be9"),i=s("5984");for(var o in i)"default"!==o&&function(t){s.d(e,t,function(){return i[t]})}(o);s("4025");var r,n=s("f0c5"),u=Object(n["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);e["default"]=u.exports},f0a7:function(t,e,s){"use strict";(function(t){s("505a"),s("921b");a(s("66fd"));var e=a(s("adbe"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("6e42")["createPage"])}},[["f0a7","common/runtime","common/vendor"]]]);