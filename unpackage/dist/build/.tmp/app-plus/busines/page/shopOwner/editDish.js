(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["busines/page/shopOwner/editDish"],{"0b73":function(e,s,i){"use strict";i.r(s);var t=i("1901"),n=i.n(t);for(var a in t)"default"!==a&&function(e){i.d(s,e,function(){return t[e]})}(a);s["default"]=n.a},1901:function(e,s,i){"use strict";(function(e,i){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var t={data:function(){return{dishList:[],dishIndex:-1,goodsId:"",goodImgs:[],foodIds:[],token:"",dishStatus:"",flagList:[{value:"1",name:"本店招牌",check:!1},{value:"2",name:"为您优选",check:!1},{value:"3",name:"主厨推荐",check:!1}],name:"",status:"1",chenben_price:"",price:"",sale_price:"",make_num:"",default_num:"20",unit:"",num:"20",warning_num:"5",ingredients:"",main:"",is_process:"",is_rexiao:"0",is_new:"1",flag:[],process:[]}},onPullDownRefresh:function(){this.goodsId&&this.getDishInfo()},onLoad:function(s){this.goodsId=s.goodsId,this.token=e.getStorageSync("kejia_order_token"),this.getDishType(),this.getdishStatus(),this.goodsId&&this.getDishInfo()},methods:{getDishInfo:function(){var s=this;s.$api.ajax("smdc/food/getonefood",{shop_id:s.$store.state.shopId,id:s.goodsId},function(t){setTimeout(function(){e.stopPullDownRefresh()},1500),console.log(i(t.data.food.make_num," at busines\\page\\shopOwner\\editDish.vue:332"));var n=t.data.food;s.name=n.name,s.make_num=n.make_num||"3",s.is_rexiao=n.is_rexiao||"0",s.main=n.main,s.ingredients=n.ingredients,s.price=n.price,s.chenben_price=n.chenben_price,s.sale_price=n.sale_price,s.num=n.num,s.unit=n.unit,s.status=n.status,s.goodImgs=n.img_ids,s.is_new=n.is_new||"0",s.is_process=JSON.stringify(n.is_process)||"0",s.foodIds=n.img_id.split(","),s.cover=s.foodIds[0],"1"==s.is_process&&(s.process=n.process.split(","),s.dishStatus.map(function(e){s.process.map(function(s){e.id==s&&(e.check=!0)})})),"1"==n.top&&(s.flagList[0].check=!0),"1"==n.youxuan&&(s.flagList[1].check=!0),"1"==n.is_zhuchu&&(s.flagList[2].check=!0);for(var a=0;a<s.dishList.length;a++)s.dishStatus[a].id==n.cat_id&&(s.dishIndex=a)},"POST",!0)},getDishType:function(e){var s=this;s.$api.ajax("smdc/food/get_cat",{shop_id:s.$store.state.shopId},function(e){s.dishList=e.data})},getdishStatus:function(){var e=this;e.$api.ajax("smdc/food_process/processLists",{shop_id:e.$store.state.shopId},function(s){e.dishStatus=s.data,e.dishStatus.map(function(e){e.check=!1})})},lookImg:function(s){var i=this;e.previewImage({urls:i.goodImgs,current:s,loop:!0,indicator:"number"})},selectDish:function(e){this.dishIndex=e.detail.value},getXP:function(e){this.is_new=e.detail.value},getSJ:function(e){this.status=e.detail.value},getdishLC:function(e){this.is_process=e.detail.value,"0"==this.is_process&&(this.process="")},getdishHot:function(e){this.is_rexiao=e.detail.value},getdishFlag:function(e){this.flag=e.detail.value},getDishProcess:function(e){this.process=e.detail.value},chooseImg:function(){var s=this;e.chooseImage({success:function(e){s.uploadImg(e.tempFilePaths[0])}})},delImg:function(e){this.goodImgs.splice(e,1),this.foodIds.splice(e,1)},uploadImg:function(s){var i=this;e.uploadFile({url:i.$api._api_root+"smdc/upload/images?token="+i.token+"&shop_id="+i.$store.state.shopId+"&uniacid=1",filePath:s,name:"image",success:function(e){var s=JSON.parse(e.data);i.goodImgs.push(s.data.url),i.foodIds.push(s.data.id)}})},addDish:function(){var s=this;if(s.name)if(s.goodImgs.length)if(s.price&&s.sale_price)if(s.dishIndex<0)s.$api.toast("请选择菜品分类");else if(s.unit)if(s.main)if(s.ingredients)if("1"!=s.is_process||0!=s.process.length){var i="0",t="0",n="0";s.flag.length&&s.flag.map(function(e){switch(e){case"1":i="1";break;case"2":t="1";break;case"3":n="1";break;default:break}});var a={shop_id:s.$store.state.shopId,cat_id:s.dishStatus[s.dishIndex].id,id:s.goodsId||0,name:s.name,price:s.price,chenben_price:s.chenben_price,sale_price:s.sale_price,unit:s.unit,img_ids:s.foodIds.length?s.foodIds.join(","):"",default_num:s.default_num,warning_num:s.warning_num,num:s.num,is_new:s.is_new,is_zhuchu:n,is_rexiao:s.is_rexiao,make_num:s.make_num,process:s.process.length?s.process.join(","):"",is_process:s.is_process,main:s.main,ingredients:s.ingredients,status:s.status,top:i,youxuan:t,cover:s.foodIds[0]};s.$api.ajax("smdc/food/toAddOrEdit",a,function(i){s.$api.toast("操作成功~"),setTimeout(function(){e.navigateBack()},2e3)},"POST",!0)}else s.$api.toast("请设置制菜流程");else s.$api.toast("请填写菜品辅料");else s.$api.toast("请填写菜品主料");else s.$api.toast("请设置菜品单位");else s.$api.toast("请设置菜品价格");else s.$api.toast("至少上传一张菜品图片");else s.$api.toast("请输入菜品名称")}}};s.default=t}).call(this,i("6e42")["default"],i("0de9")["default"])},"1ea5":function(e,s,i){"use strict";(function(e){i("505a"),i("921b");t(i("66fd"));var s=t(i("2709"));function t(e){return e&&e.__esModule?e:{default:e}}e(s.default)}).call(this,i("6e42")["createPage"])},2709:function(e,s,i){"use strict";i.r(s);var t=i("7b14"),n=i("0b73");for(var a in n)"default"!==a&&function(e){i.d(s,e,function(){return n[e]})}(a);i("7720");var o,c=i("f0c5"),u=Object(c["a"])(n["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],o);s["default"]=u.exports},"5c44":function(e,s,i){},7720:function(e,s,i){"use strict";var t=i("5c44"),n=i.n(t);n.a},"7b14":function(e,s,i){"use strict";var t,n=function(){var e=this,s=e.$createElement;e._self._c},a=[];i.d(s,"b",function(){return n}),i.d(s,"c",function(){return a}),i.d(s,"a",function(){return t})}},[["1ea5","common/runtime","common/vendor"]]]);