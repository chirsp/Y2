(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/menu/menu"],{"01f8":function(t,e,o){},"18e6":function(t,e,o){"use strict";(function(t){o("505a"),o("921b");n(o("66fd"));var e=n(o("e88e"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("6e42")["createPage"])},"55bc":function(t,e,o){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o("2f62");function i(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},n=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),n.forEach(function(e){s(t,e,o[e])})}return t}function s(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var r=t.getSystemInfoSync(),d=function(){return o.e("components/footer").then(o.bind(null,"e6ad"))},c=function(){return o.e("components/goods").then(o.bind(null,"b923"))},u=function(){return o.e("components/evaluate").then(o.bind(null,"969a"))},l=function(){return o.e("components/drag-button").then(o.bind(null,"bc24"))},f=function(){return o.e("components/nodata").then(o.bind(null,"b7f3"))},h=function(){return o.e("components/showmodal").then(o.bind(null,"b674"))},p={data:function(){return{sys:r,keyWord:"",scroll_h:0,current:0,tab:[],mask_show:!1,totalCount:0,totalMoney:0,originMoney:0,status:1,isIpx:-1,foodlist:[],page:1,isLoad:!1,refresh:!1,Tab:["点餐","评价"],TabCur:0,scrollLeft:0,listeva:"",order_id:"",evaCount:0,cartList:"",orderId:"",orderNo:"",canwei_price:0,scanModal:!1}},computed:(0,a.mapState)(["_buyList","_orderId","_orderNo","_config","deskNum","needScan"]),components:{xFooter:d,goods:c,evaluate:u,dragButton:l,nodata:f,showmodal:h},onPullDownRefresh:function(){this.getList()},onReachBottom:function(){this.isLoad||1==this.TabCur&&(this.page++,this.init())},onLoad:function(){this.isIpx=r.model.indexOf("iPhone X");var t=this.$api.getStorage("wx_audit");this.status=t.status,this.canwei_price=(parseFloat(this._config.table_fee)+parseFloat(this._config.season_fee))*parseFloat(this.deskNum)},onShow:function(){this.needScan?t.redirectTo({url:"../index/scan"}):(this.getScrollHeight(),this.getMenuList(),this.init(),this.getCart())},methods:i({},(0,a.mapMutations)(["_addBuyList","_removeBuyList","_clearBuyList","_initBuyList"]),{sure:function(t){if(t){var e=this;e.$api.ajax("smdc/message/toAddWaitMessage",{shop_id:e.$store.state.shopId,no:e.$store.state.deskId},function(t){e.scanModal=!1,e.$api.toast("稍等片刻,服务员马上就来!")})}},hide:function(t){this.scanModal=!1},btnClick:function(){this.scanModal=!0},init:function(){var t=this;t.isLoad=!0,t.$api.ajax("smdc/Comment/index",{shop_id:t.$store.state.shopId,order_id:t.order_id,page:t.page,limit:10},function(e){t.isLoad=!1,t.evaCount=e.count,1==t.page?t.listeva=e.data:t.listeva.concat(e.data)})},tabSelect:function(t){this.TabCur=t.currentTarget.dataset.id,this.scrollLeft=60*(t.currentTarget.dataset.id-1),this.page=1},getMore:function(){this.getList()},doSearch:function(){this.$api.openWin("../goodsList/goodsList")},getScrollHeight:function(){var t=r.windowHeight,e=r.windowWidth,o=300,n=o/2*(e/375);this.scroll_h=t-n},changeCurrent:function(t){this.current=t,this.getList()},getMenuList:function(){var t=this;t.$api.ajax("smdc/food/get_cat",{shop_id:t.$store.state.shopId,deskid:t.$store.state.deskId},function(e){t.tab=e.data,t.getList()})},getList:function(){var e=this;e.$api.ajax("smdc/cart/food",{shop_id:e.$store.state.shopId,deskid:e.$store.state.deskId,search:"",type:"",limit:10,page:e.page,cat_id:e.tab[e.current].id},function(o){var n=o.data.foodlist;setTimeout(function(){t.stopPullDownRefresh()},1e3),e.totalCount=o.data.totalCount,e.totalMoney=o.data.totalMoney,e.originMoney=o.data.originMoney,n.length?1==e.page?e.foodlist=n:e.foodlist=e.foodlist.concat(n):(e.foodlist=[],e.more=!1)},"POST",!0)},getCart:function(){var t=this;t.$api.ajax("smdc/cart/cartList",{shop_id:t.$store.state.shopId,deskid:t.$store.state.deskId},function(e){t.cartList=e.data.foodlist})},checkOrder:function(){var t=this;t.$api.ajax("smdc/desk/getDetail",{shop_id:t.$store.state.shopId,no:t.$store.state.deskId},function(e){if(e.data&&e.data.order_id){var o=e.data.order_id;t.addfunction(o)}else{var n="";t.totalMoney=parseFloat(t.totalMoney)+parseFloat(t.canwei_price),t.addfunction(n)}},"POST")},addfunction:function(e){var o=this;o.$api.ajax("smdc/order/addorder",{shop_id:o.$store.state.shopId,deskid:o.$store.state.deskId,custom:o.$store.state.deskNum,sale_type:o.eatType||0,total_price:o.totalMoney,desk_price:o._config.table_fee,couponid:0,foodlist:JSON.stringify(o.cartList),coupon_price:0,bz:"",codeNo:"",formid:""},function(a){console.log(n(a.data.order_no," at pages\\menu\\menu.vue:333"));var i=a.data.order_no,s=a.data.order_id;o.orderNo=i,o.orderId=s,o.clearBuyCar(),o.$api.toast("提交成功","success"),o.$store.commit("_setOrderId",{orderId:o.orderId,orderNo:o.orderNo}),t.navigateTo({url:"../order-details/order-details?orderId="+o.orderId+"&type=1&alreadyOId="+e})},"POST",!0)},addNums:function(t){var e=this,o=t.type;if(1==o)var n=e.foodlist[t.index].id;else n=e.cartList[t.index].id;e.$api.ajax("smdc/cart/add",{shop_id:e.$store.state.shopId,deskid:e.$store.state.deskId,id:n},function(t){e.getList(),e.getCart()})},removeNums:function(t){var e=this,o=t.type;if(1==o)var n=e.foodlist[t.index].id;else n=e.cartList[t.index].id;e.$api.ajax("smdc/cart/sub",{shop_id:e.$store.state.shopId,deskid:e.$store.state.deskId,id:n},function(t){e.getList(),e.getCart()})},clearBuyCar:function(){var t=this;t.$api.ajax("smdc/cart/clearAll",{shop_id:t.$store.state.shopId,deskid:t.$store.state.deskId},function(e){t.mask_show=!1,t.getList()})},showMask:function(){this.mask_show=!0},hideMask:function(){this.mask_show=!1},toggleMask:function(){this.totalMoney?(this.getCart(),this.mask_show=!this.mask_show):console.log(n("未点单"," at pages\\menu\\menu.vue:411"))},totalPrice:function(){var t=0,e=0,o=0;this._buyList.forEach(function(n){return n.num&&("0.00"==n.sale_price?t+=n.price*parseInt(n.num):t+=n.sale_price*parseInt(n.num)),n.num&&(o+=n.price*parseInt(n.num)),n.num?e+=n.num:""}),this.totalMoney=parseFloat(t).toFixed(2),this.originMoney=parseFloat(o).toFixed(2),this.totalCount=e},getOrder:function(){0!=this.totalCount&&"0"!=this.totalCount&&this.checkOrder()}})};e.default=p}).call(this,o("6e42")["default"],o("0de9")["default"])},"591d":function(t,e,o){"use strict";var n=o("01f8"),a=o.n(n);a.a},"6f47":function(t,e,o){"use strict";o.r(e);var n=o("55bc"),a=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,function(){return n[t]})}(i);e["default"]=a.a},e88e:function(t,e,o){"use strict";o.r(e);var n=o("ea6d"),a=o("6f47");for(var i in a)"default"!==i&&function(t){o.d(e,t,function(){return a[t]})}(i);o("591d");var s,r=o("f0c5"),d=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=d.exports},ea6d:function(t,e,o){"use strict";var n,a=function(){var t=this,e=t.$createElement;t._self._c},i=[];o.d(e,"b",function(){return a}),o.d(e,"c",function(){return i}),o.d(e,"a",function(){return n})}},[["18e6","common/runtime","common/vendor"]]]);